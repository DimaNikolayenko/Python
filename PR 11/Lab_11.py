import pandas as pd

# 1. Словник з даними багажу
baggage = {
    1: {"кількість": 3, "вага": 45.0},
    2: {"кількість": 1, "вага": 23.0},
    3: {"кількість": 5, "вага": 72.5},
    4: {"кількість": 2, "вага": 40.0},
    5: {"кількість": 4, "вага": 58.0},
    6: {"кількість": 3, "вага": 46.2},
    7: {"кількість": 1, "вага": 28.0},
    8: {"кількість": 2, "вага": 39.5},
    9: {"кількість": 3, "вага": 44.0},
    10: {"кількість": 1, "вага": 24.5}
}

# Перетворюємо словник у DataFrame
df = pd.DataFrame(baggage).T
df.index.name = 'Пасажир'

# Додаємо стовпець "Клас квитка"
df['Клас_Квитка'] = [1,1,2,1,2,1,1,2,1,1]

print("### Початковий DataFrame ###")
print(df)

# 2. Базовий аналіз
print("\nПерші 3 рядки:\n", df.head(3))
print("\nТипи даних:\n", df.dtypes)
print("\nРозмір DataFrame:", df.shape)
print("\nОписова статистика:\n", df.describe())

# 3. Додаємо розрахунковий стовпець
df['Середня_Вага_Речі'] = df['вага'] / df['кількість']
print("\nDataFrame з розрахунковим стовпцем:\n", df)

# 4. Фільтрація: багаж більше 45 кг
print("\nБагаж > 45 кг:\n", df[df['вага'] > 45])

# 5. Сортування за спаданням ваги
print("\nСортування за вагою (спадання):\n", df.sort_values('вага', ascending=False))

# 6. Групування та середнє значення кількості речей
print("\nСередня кількість речей за Класом квитка:\n", df.groupby('Клас_Квитка')['кількість'].mean())

# 7. Додаткові агрегації
print("\nМаксимальна вага багажу за Класом:\n", df.groupby('Клас_Квитка')['вага'].max())
print("Кількість унікальних значень кількості речей:", df['кількість'].nunique())